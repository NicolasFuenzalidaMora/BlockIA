<ion-content [fullscreen]="true" class="historial-content">

  <div class="historial-sheet ion-padding">

    <!-- ENCABEZADO -->
    <section class="header-block">
      <h1>Historial</h1>
      <p>Tus accesos se registran aquí.</p>
    </section>

    <!-- ESTADO CARGANDO -->
    <div *ngIf="cargando" class="loading-block">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Cargando historial...</p>
    </div>

    <!-- ESTADO VACÍO -->
    <section *ngIf="!cargando && historial.length === 0" class="empty-block">
      <div class="empty-icon">
        <ion-icon name="time-outline"></ion-icon>
      </div>
      <h2>Sin accesos aún</h2>
      <p>Cuando utilices la app para abrir el portón, aparecerán aquí.</p>
    </section>

    <!-- LISTA DE ACCESOS -->
    <section *ngIf="!cargando && historial.length > 0" class="historial-list">
      <div class="access-card" *ngFor="let r of historial">

        <!-- Encabezado de tarjeta -->
        <div class="card-head">
          <div class="patente-circle">
            {{ (r.patente || '---') | slice:0:3 }}
          </div>

          <div class="head-info">
            <h3>{{ r.patente || 'Patente no registrada' }}</h3>
            <p class="user-name">{{ r.nombreUsuario || 'Yo' }}</p>
          </div>
        </div>

        <!-- Detalles de acceso -->
        <div class="card-body">

          <div class="info-row">
            <ion-icon name="business-outline"></ion-icon>
            <div>
              <p class="label">Condominio</p>
              <p class="value">{{ r.nombreCondominio }}</p>
            </div>
          </div>

          <div class="info-row">
            <ion-icon name="time-outline"></ion-icon>
            <div>
              <p class="label">Fecha</p>
              <p class="value">
                {{ r.hora.toDate() | localDate }}
                a las
                {{ r.hora.toDate() | localDate:'short' }}
              </p>
            </div>
          </div>

        </div>

      </div>
    </section>

  </div>

  <!-- Barra inferior -->
  <app-menu-lateral></app-menu-lateral>
</ion-content>
